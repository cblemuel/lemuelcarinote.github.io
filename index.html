<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Roboto&display=swap" rel="stylesheet">
    <link rel="icon" href="https://cld.partsimg.com/image/upload/h_200,w_200,f_auto,q_auto/carparts/logos/badge/blue/CP_BADGE_RGB_BLUE_HR.png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSR Voice CSAT Survey</title>
    <style>
        
        body {
            font-family: 'Roboto', Arial, sans-serif;
            margin: 15px;
        }

        .wrapper {
            display: block;
            margin: 0 auto;
            max-width: 600px;
        }

        .row {
            padding: 15px 0
        }

        .row .logo {
            display: block;
            margin: 0 auto;
        }

        .logo {
            width: 220px;
            height: auto;
        }

        h3 {
            line-height: 140%;
            font-family: 'Inter', Arial, sans-serif
        }

        ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        li {
            padding-top: 5px;
            padding-right: 15px;
            display: inline-block
        }

        label {
            display: inline-block;
            margin-bottom: 5px;
            line-height: 140%
        }

        input[type="radio"] label {
            margin-bottom: 15px;
            margin-right: 15px;
        }

        textarea {
            margin-top: 5px;
            padding: 10px;
            width: 100%
        }

        input[type="submit"] {
            background-color: #ffcd05;
            border: none;
            color: #282832;
            padding: 12px 20px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            cursor: pointer;
            border-radius: 4px;
            font-weight: bold;
            font-family: 'Inter', Arial, sans-serif
        }

        #response {
            display: none
        }
        
        #response p {
            font-size: 13px;
            display: inline-block
        }

        #error {
            display: none
        }

        #error p {
            color: #cc0202;
            font-size: 13px;
            display: inline-block
        }
    </style>
</head>
<body>

<div class="wrapper">
    <div class="row">
        <img class="logo" src="https://cld.partsimg.com/image/upload/carparts/blog/landing-pages/difm/p2/wordmark-colour.svg" alt="CarParts.com">
    </div>
    
    <div id="form_widget">
        <h3>Thank you for contacting us regarding your auto parts purchase. We want to be sure that you were satisfied with the level of service we provided.</h3>
        <form name="csat">
            <div class="row">
                <label for="satisfaction">How satisfied are you with the most recent interaction with our service representative?</label>
                <ul>
                    <li><input type="radio" id="satisfaction1" name="satisfaction" value="1"><label for="satisfaction1">&nbsp;1</label></li>
                    <li><input type="radio" id="satisfaction2" name="satisfaction" value="2"><label for="satisfaction2">&nbsp;2</label></li>
                    <li><input type="radio" id="satisfaction3" name="satisfaction" value="3"><label for="satisfaction3">&nbsp;3</label></li>
                    <li><input type="radio" id="satisfaction4" name="satisfaction" value="4"><label for="satisfaction4">&nbsp;4</label></li>
                    <li><input type="radio" id="satisfaction5" name="satisfaction" value="5"><label for="satisfaction5">&nbsp;5</label></li>
                </ul>
            </div>

            <div class="row">
                <label for="resolve">Did we resolve your problem?</label>
                <div>
                    <input type="radio" id="resolveYes" name="resolve" value="Yes">
                    <label for="resolveYes">Yes</label>
                    <input type="radio" id="resolveNo" name="resolve" value="No">
                    <label for="resolveNo">No</label>
                </div>
            </div>

            <div class="row">
                <label for="comments">You are welcome to share any comments or feedback in the space provided below.</label>
                <textarea id="comments" name="comments" rows="4" cols="50" value=""></textarea>
            </div>

            <div class="row">
                <input id="btnSubmit" type="submit" value="Submit">
                <div id="response">
                    <p id="note">Please wait...</p>
                </div>
                <div id="error">
                    <p id="msg">Please provide answers.</p>
                </div>
            </div>
        </form>
    </div>

</div>

    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

    <script>
        var form = document.forms['csat'];
        var btnSubmit = document.getElementById("btnSubmit");
        var successNote = document.getElementById("successNote");
        var successIcon = document.getElementById("successIcon");
        var radioSatisfaction = document.getElementsByName("satisfaction");
        var radioResolve = document.getElementsByName("resolve");
        var textboxComments = document.getElementById("comments");
        var responseDiv = document.getElementById("response");
        var errorDiv = document.getElementById("error");

        form.addEventListener('submit', e => {
            e.preventDefault()
            responseDiv.style.display = "block";
            var xhr = new XMLHttpRequest();
            var queryString = window.location.search;
            var urlParams = new URLSearchParams(queryString);
            var email = atob(urlParams.get('em'));
            var agent_username = atob(urlParams.get('an'));
            var order_id = atob(urlParams.get('oi'));
            var domain_name = atob(urlParams.get('dm'));
            var disposition = atob(urlParams.get('ds'));
            var radioselectedValues = {
                satisfaction: $("input[name='satisfaction']:checked").val(),
                resolve: $("input[name='resolve']:checked").val()
            };
            var comments = document.getElementById("comments").value;
            var message = "Order Id: " + order_id
                + "\nPurchase Medium: " + domain_name
                + "\nDisposition: " + disposition
                + "\n\nCSR: " + agent_username 
                + "\n\nHow satisfied are you with the most recent interaction with our service representative? \n" + radioselectedValues.satisfaction
                + "\n\nDid we resolve your problem? \n" + radioselectedValues.resolve
                + "\n\nComments or Feedback: \n" + comments;
            var data = {};
            data.title = "CSR Voice CSAT Survey";
            data.email = email;
            data.message = message;
            data.agent_username = agent_username;
            data.order_id = order_id;
            data.domain_name = domain_name;
            data.disposition = disposition;
            data.satisfaction = radioselectedValues.satisfaction;
            data.resolve = radioselectedValues.resolve;
            data.comments = comments; 
            if (radioselectedValues.satisfaction === "" || radioselectedValues.satisfaction === undefined || radioselectedValues.resolve === "" || radioselectedValues.resolve === undefined) {
                errorDiv.style.display = "block"
            } else {
                xhr.open('POST', 'https://api.kustomerapp.com/v1/hooks/form/62ab35f54d6d983dd120afb0/6ff02ab5fceb6215898281533c8138872ad096d908bd5174545726d9f836a5b0');
                xhr.setRequestHeader("Accept", "application/json;charset=UTF-8");
                xhr.setRequestHeader("Authorization", "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY1NzlkNDhmNTU4YzIxYzYyZGY1MTk0ZiIsInVzZXIiOiI2NTc5ZDQ4ZDAwMzE4MzVmNDhhYTAyMjgiLCJvcmciOiI2MmFiMzVmNTRkNmQ5ODNkZDEyMGFmYjAiLCJvcmdOYW1lIjoiY2FycGFydHMiLCJ1c2VyVHlwZSI6Im1hY2hpbmUiLCJwb2QiOiJwcm9kMSIsInJvbGVzIjpbIm9yZy5hZG1pbiJdLCJhdWQiOiJ1cm46Y29uc3VtZXIiLCJpc3MiOiJ1cm46YXBpIiwic3ViIjoiNjU3OWQ0OGQwMDMxODM1ZjQ4YWEwMjI4In0.hHPqxf04wPqBGyiMjllKqOswPhPMnFoLdaSReRrK5ME");
                xhr.onreadystatechange = function () {
                    if (xhr.status === 200) {
                        console.log(message);
                        successNote.style.display = "block",
                        successIcon.style.display = "block",
                        form.btnSubmit.value = "Submitted",
                        form.btnSubmit.disabled = true,
                        form.btnSubmit.style.cursor = "default",
                        form.note.value = "Thank you for your feedback!", 
                        errorDiv.style.display = "none"
                    }};
                xhr.send(JSON.stringify(data));
            }
        })
    </script>

    
    <!-- 
    https://efmfeed.verintefm.com/se/0A88B8A45D232866?wsb9=rdelosreyes&wsb10=68593003&wsb18=sales.carparts.com&wsb17=S+Order+Completed

    em=bGNhcmlub3RlQGdtYWlsLmNvbQ%3D%3D%0A&an=lcarinote&oid=12345567&cn=sales.console.com&ds=Order+Completed
    
    bGNhcmlub3RlQGdtYWlsLmNvbQ%3D%3D%0A
    bGVtdWVsY2FyaW5vdGVAZ21haWwuY29t%0A

    https://lemuelcarinote.github.io/?em=bGNhcmlub3RlQGdtYWlsLmNvbQ%3D%3D%0A&an=bGNhcmlub3Rl%0A&oi=MTIzNDU1Njc%3D%0A&dm=c2FsZXMuY29uc29sZS5jb20%3D%0A&ds=T3JkZXIgQ29tcGxldGVk%0A

    -->
</body>
</html>
